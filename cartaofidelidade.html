<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>vip cortes</title>
  <link rel="stylesheet" href="fidelidade.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Big+Shoulders:opsz,wght@10..72,100..900&display=swap"
    rel="stylesheet">

</head>

<body>
  <header>
    <div class="traco1">
      <img class="tracos" src="./assets/menu (sidebar).png" alt="3 traços">
    </div>
    <div class="caixa-one">
      <img class="img-one" src="./assets/Vip cortes logo.png" alt="logo">
      <a class="item" href="./index.html"><b>Home</b></a>
      <a class="item" href="./Avaliações.html"><b>Avaliações</b></a>
      <a class="item" href="./AGENDAR.html"><b>Agendar</b></a>

    </div>

    <div class="caixa-two">
      <a class="item-two" href="./cartaofidelidade.html"><b>Entrar</b></a>
      <a class="item-three" href="./criandoconta.html"><b>Cadastre-se</b></a>

    </div>
   
  </header>
    
  <div class="line"></div>
  <section>
    <span class="item-four"><b>CARTÃO</b></span>
    <span class="item-five"><b>FIDELIDADE</b></span>

  </section>
  <main>
    <img src="./assets/tela 1.png" alt="tela" class="tela">
    <div class="caixa-ten">
      <input type="text" id="loginNome" placeholder="Nome:" class="botao" autocomplete="off">
      <input type="password" id="loginSenha" placeholder="Senha:" class="botao2" autocomplete="off">
    </div>
    <div class="caixa-eleven">
      <button class="botao3" id="btnEntrar">Entrar Agora</button>
      <button class="botao4" id="btnCancelar">Cancelar Cartão</button>
    </div>
    <div class="caixa-aviso">
      <span>Caso não Possua um login, pressione O BOTÃO “CADASTRAR-SE” PARA USUFRUIR DE DESCONTOS E BÔNUS INCRÍVEIS POR APENAS CORTAR O CABELO REGULARMENTE! </span>

    </div>
    <div class="caixa-cadastre">
      <a class="botao5" href="criandoconta.html">CADASTRE-SE</a>
    </div>
  </main>

  <script>
    async function autenticarUsuario(nome, senha) {
      try {
        const response = await fetch('/api/usuarios/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ nome, senha })
        });
        const data = await response.json();
        if (response.ok && data.usuario) {
          sessionStorage.setItem('usuarioId', data.usuario.id);
          sessionStorage.setItem('usuarioNome', data.usuario.nome);
          sessionStorage.setItem('usuarioTelefone', data.usuario.telefone || '');
          sessionStorage.setItem('autenticado', 'true');
          alert('Login realizado com sucesso!');
          window.location.href = './perfil.html';
          return;
        }
        alert('Erro no login: ' + (data.error || 'Credenciais incorretas'));
      } catch (err) {
        console.error('Erro ao conectar ao servidor:', err);
        alert('Não foi possível conectar ao servidor. Tente novamente mais tarde.');
      }
    }

    document.getElementById('btnEntrar').addEventListener('click', () => {
      const nome = document.getElementById('loginNome').value.trim();
      const senha = document.getElementById('loginSenha').value.trim();
      if (!nome || !senha) { alert('Preencha nome e senha'); return; }
      autenticarUsuario(nome, senha);
    });

    document.getElementById('loginSenha').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') document.getElementById('btnEntrar').click();
    });
  </script>

</body>

</html>


