<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vip cortes</title>
    <link rel="stylesheet" href="conta.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Big+Shoulders:opsz,wght@10..72,100..900&display=swap"
        rel="stylesheet">
</head>

<body>
    <header>
        <div class="traco1">
            <img class="tracos" src="./assets/menu (sidebar).png" alt="3 traços">
        </div>
        <div class="caixa-one">
            <img class="img-one" src="./assets/Vip cortes logo.png" alt="logo">
            <a class="item" href="./index.html"><b>Home</b></a>
            <a class="item" href="./Avaliações.html"><b>Avaliações</b></a>
            <a class="item" href="./AGENDAR.html"><b>Agendar</b></a>
        </div>

        <div class="caixa-two">
            <a class="item-two" href="./cartaofidelidade.html"><b>Entrar</b></a>
            <a class="item-three" href="./criandoconta.html"><b>Cadastre-se</b></a>
        </div>
    </header>
    
    <div class="line"></div>
    
    <section>
        <span class="item-four"><b>CARTÃO</b></span>
        <span class="item-five"><b>FIDELIDADE</b></span>
    </section>
    
    <main>
        <img src="./assets/tela 2.png" alt="tela" class="tela">
        <div class="caixa-none">
            <span class="fidelidade">Criando Conta</span>
        </div>
        <div class="caixa-ten">
            <form class="formulario" id="formulario">
                <input id="Nome" type="text" placeholder="Nome:" class="botao" required>
                <input id="Email" type="email" placeholder="Email:" class="botao2" required>
                <input id="Telefone" type="text" placeholder="Telefone:" class="botao3" required>
                <input id="Data" type="text" placeholder="Data de Nascimento:" class="botao4">
                <input id="Senha" type="password" placeholder="Crie uma senha:" class="botao5" required>

                <div class="caixa-vinte">
                    <button type="submit" class="botao5">Enviar e Entrar</button>
                </div>
            </form>
            <div id="mensagem" style="margin-top: 12px; color: #900; font-weight: bold;"></div>
        </div>
    </main>

    <script>
        document.getElementById('formulario').addEventListener('submit', async function (e) {
            e.preventDefault();
            
            const name = document.getElementById('Nome').value.trim();
            const email = document.getElementById('Email').value.trim();
            const phone = document.getElementById('Telefone').value.trim();
            const password = document.getElementById('Senha').value.trim();
            const msg = document.getElementById('mensagem');
            
            msg.textContent = '';
            msg.style.color = '#900';
            
            if (!name || !email || !password) {
                msg.textContent = 'Preencha nome, email e senha.';
                return;
            }
            
            try {
                const res = await fetch('/api/signup', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password, phone })
                });
                const j = await res.json();
                
                if (!res.ok) {
                    msg.textContent = j.error || 'Erro ao criar conta';
                    return;
                }
                
                // Salvar userId e redirecionar
                localStorage.setItem('userId', j.userId);
                window.location.href = 'perfil.html';
            } catch (err) {
                console.error(err);
                msg.textContent = 'Erro ao conectar ao servidor.';
            }
        });
    </script>
</body>

</html>